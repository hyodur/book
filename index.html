<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📚 개인 장서 대출 관리</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>📚 개인 장서 대출 관리 시스템</h1>
            <p class="subtitle">우리 반 책 대출을 쉽고 편리하게</p>
        </header>

        <!-- 탭 메뉴 -->
        <div class="tab-menu">
            <button class="tab-btn active" data-tab="loan">대출/반납</button>
            <button class="tab-btn" data-tab="books">도서 관리</button>
            <button class="tab-btn" data-tab="students">학생 관리</button>
            <button class="tab-btn" data-tab="stats">통계</button>
        </div>

        <!-- 대출/반납 탭 -->
        <div class="tab-content active" id="loan-tab">
            <div class="section">
                <h2>🔍 책 검색</h2>
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="책 제목, 저자, 고유번호로 검색...">
                    <button id="search-btn" class="btn btn-primary">검색</button>
                </div>
            </div>

            <div class="section">
                <h2>📖 대출 가능한 책</h2>
                <div id="available-books" class="book-list">
                    <p class="empty-state">등록된 책이 없습니다. 도서 관리에서 책을 추가해주세요.</p>
                </div>
            </div>

            <div class="section">
                <h2>📕 대출 중인 책</h2>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">전체</button>
                    <button class="filter-btn" data-filter="normal">정상</button>
                    <button class="filter-btn" data-filter="overdue">연체</button>
                </div>
                <div id="loaned-books" class="book-list">
                    <p class="empty-state">대출 중인 책이 없습니다.</p>
                </div>
            </div>
        </div>

        <!-- 도서 관리 탭 -->
        <div class="tab-content" id="books-tab">
            <div class="section">
                <h2>➕ 새 도서 등록</h2>
                <form id="book-form" class="form">
                    <div class="form-group">
                        <label for="book-id">고유번호</label>
                        <input type="text" id="book-id" placeholder="예: B001 (자동 생성됨)">
                        <small>비워두면 자동으로 생성됩니다</small>
                    </div>
                    <div class="form-group">
                        <label for="book-title">도서명 *</label>
                        <input type="text" id="book-title" placeholder="예: 해리포터와 마법사의 돌" required>
                    </div>
                    <div class="form-group">
                        <label for="book-author">저자</label>
                        <input type="text" id="book-author" placeholder="예: J.K. 롤링">
                    </div>
                    <div class="form-group">
                        <label for="book-publisher">출판사</label>
                        <input type="text" id="book-publisher" placeholder="예: 문학수첩">
                    </div>
                    <button type="submit" class="btn btn-primary">도서 등록</button>
                </form>
            </div>

            <div class="section">
                <h2>📚 전체 도서 목록</h2>
                <div id="all-books" class="table-container">
                    <table class="books-table">
                        <thead>
                            <tr>
                                <th>고유번호</th>
                                <th>도서명</th>
                                <th>저자</th>
                                <th>상태</th>
                                <th>관리</th>
                            </tr>
                        </thead>
                        <tbody id="books-table-body">
                            <tr>
                                <td colspan="5" class="empty-state">등록된 도서가 없습니다.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 학생 관리 탭 -->
        <div class="tab-content" id="students-tab">
            <div class="section">
                <h2>➕ 학생 추가</h2>
                <form id="student-form" class="form">
                    <div class="form-group">
                        <label for="student-number">번호</label>
                        <input type="number" id="student-number" placeholder="예: 1" min="1">
                        <small>비워두면 자동으로 순번이 부여됩니다</small>
                    </div>
                    <div class="form-group">
                        <label for="student-name">이름 *</label>
                        <input type="text" id="student-name" placeholder="예: 홍길동" required>
                    </div>
                    <button type="submit" class="btn btn-primary">학생 추가</button>
                </form>
            </div>

            <div class="section">
                <h2>📋 학생 일괄 등록</h2>
                <div class="bulk-register-tabs">
                    <button class="bulk-tab-btn active" data-bulk-tab="text">텍스트 입력</button>
                    <button class="bulk-tab-btn" data-bulk-tab="csv">CSV 업로드</button>
                </div>

                <!-- 텍스트 일괄 등록 -->
                <div class="bulk-tab-content active" id="bulk-text-tab">
                    <form id="bulk-student-form" class="form">
                        <div class="form-group">
                            <label for="bulk-student-text">학생 목록 (한 줄에 한 명씩)</label>
                            <textarea id="bulk-student-text" placeholder="1 홍길동
2 김철수
3 이영희
또는
홍길동
김철수
이영희

(번호는 선택사항, 없으면 자동 부여)" rows="10"></textarea>
                            <small>💡 "번호 이름" 또는 "이름"만 입력하세요. 탭이나 공백으로 구분됩니다.</small>
                        </div>
                        <button type="submit" class="btn btn-primary">일괄 등록</button>
                    </form>
                </div>

                <!-- CSV 일괄 등록 -->
                <div class="bulk-tab-content" id="bulk-csv-tab">
                    <div class="form">
                        <div class="form-group">
                            <label>CSV 파일 업로드</label>
                            <div class="file-upload-box">
                                <input type="file" id="csv-upload" accept=".csv,.txt" style="display: none;">
                                <button type="button" class="btn btn-secondary" onclick="document.getElementById('csv-upload').click()">
                                    📁 CSV 파일 선택
                                </button>
                                <span id="csv-filename" class="file-name">파일을 선택하세요</span>
                            </div>
                            <small>💡 CSV 형식: 번호,이름 (예: 1,홍길동) 또는 이름만 입력</small>
                        </div>
                        <button type="button" id="csv-upload-btn" class="btn btn-primary">일괄 등록</button>
                        
                        <div class="csv-example">
                            <h4>📄 CSV 예제</h4>
                            <pre>1,홍길동
2,김철수
3,이영희</pre>
                            <p>또는 번호 없이:</p>
                            <pre>홍길동
김철수
이영희</pre>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>👥 학생 목록</h2>
                <div id="students-list" class="table-container">
                    <table class="students-table">
                        <thead>
                            <tr>
                                <th>번호</th>
                                <th>이름</th>
                                <th>대출 중</th>
                                <th>관리</th>
                            </tr>
                        </thead>
                        <tbody id="students-table-body">
                            <tr>
                                <td colspan="4" class="empty-state">등록된 학생이 없습니다.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 통계 탭 -->
        <div class="tab-content" id="stats-tab">
            <div class="section">
                <h2>📊 대출 통계</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-books">0</div>
                        <div class="stat-label">전체 도서</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="available-count">0</div>
                        <div class="stat-label">대출 가능</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="loaned-count">0</div>
                        <div class="stat-label">대출 중</div>
                    </div>
                    <div class="stat-card alert">
                        <div class="stat-value" id="overdue-count">0</div>
                        <div class="stat-label">연체</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>📈 인기 도서 Top 5</h2>
                <div id="popular-books" class="popular-list">
                    <p class="empty-state">대출 이력이 없습니다.</p>
                </div>
            </div>

            <div class="section">
                <h2>🎓 다독왕 Top 5</h2>
                <div id="top-readers" class="popular-list">
                    <p class="empty-state">대출 이력이 없습니다.</p>
                </div>
            </div>

            <div class="section">
                <h2>💾 데이터 관리</h2>
                <div class="data-management">
                    <button id="export-btn" class="btn btn-secondary">📥 데이터 내보내기 (JSON)</button>
                    <button id="import-btn" class="btn btn-secondary">📤 데이터 가져오기</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                    <button id="clear-btn" class="btn btn-danger">🗑️ 전체 데이터 초기화</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 대출 모달 -->
    <div id="loan-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="ui.closeModal()">&times;</span>
            <h2>📖 책 대출하기</h2>
            <div id="loan-book-info" class="book-info"></div>
            <form id="loan-form" class="form">
                <div class="form-group">
                    <label for="loan-student">학생 선택 *</label>
                    <select id="loan-student" required>
                        <option value="">학생을 선택하세요</option>
                    </select>
                </div>
                <div id="student-history-alert" class="alert-box" style="display: none;"></div>
                <div class="form-group">
                    <label for="loan-days">대출 기간 (일)</label>
                    <input type="number" id="loan-days" value="14" min="1" max="90">
                </div>
                <div class="form-group">
                    <label for="loan-note">메모</label>
                    <textarea id="loan-note" placeholder="특이사항을 입력하세요 (선택사항)" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">대출하기</button>
            </form>
        </div>
    </div>

    <!-- 학생 대출 이력 모달 -->
    <div id="student-history-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="ui.closeStudentHistoryModal()">&times;</span>
            <h2>📚 학생 대출 이력</h2>
            <div id="student-history-info" class="student-history-info"></div>
            <div id="student-history-content" class="student-history-content"></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
